import{a as q}from"./chunk-PI5HNATW.js";import{a as B,c as N,d as F,f as D,h as L,i as T,j,l as z}from"./chunk-ZTYZG2FQ.js";import{s as I}from"./chunk-OWIOO5ZG.js";import{b as S,c as E,e as k}from"./chunk-QSWAGUUE.js";import{Ab as g,Bb as l,Cb as x,Hb as P,Jb as p,Kb as c,Oa as e,Pa as f,Z as y,a as v,ab as m,ca as C,fa as b,fb as M,gb as O,hb as _,ib as n,jb as i,kb as s,qb as w,zb as a}from"./chunk-VVLVZ75C.js";var G=(()=>{let o=class o{constructor(t){this.http=t,this.apiUrl="https://sazanowine-api-dev.azurewebsites.net/api"}addOrder(t){return this.http.post(`${this.apiUrl}/orders`,t)}};o.\u0275fac=function(r){return new(r||o)(C(I))},o.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"});let d=o;return d})();function V(d,o){if(d&1&&(n(0,"div")(1,"h6",3),a(2),i(),n(3,"p",3),a(4),i()()),d&2){let h=o.$implicit;e(2),x("",h.wine.name," ",h.quantity,"x"),e(2),l("",h.wine.price*h.quantity," \u20BE")}}var X=(()=>{let o=class o{constructor(t,r,u){this.cartService=t,this.fb=r,this.orderService=u,this.cartItems=[]}ngOnInit(){this.getCartItems(),this.initCheckoutForm()}ngOnDestroy(){this.cartSubscription&&this.cartSubscription.unsubscribe()}onSubmit(){let t=v({},this.checkoutForm.value);delete t.cardHolderName,delete t.cardNumber,delete t.cvv,delete t.expiryDate,console.log(t),this.orderService.addOrder(t).subscribe(r=>{console.log(r)},r=>console.error(r))}getTotalAmount(){return this.cartItems.reduce((t,r)=>t+r.wine.price*r.quantity,0)}getTotalQuantity(){return this.cartItems.reduce((t,r)=>t+r.quantity,0)}getCartItems(){this.cartSubscription=this.cartService.cartItems$.subscribe(t=>{this.cartItems=t,console.log(this.cartItems)})}initCheckoutForm(){this.checkoutForm=this.fb.group({cardNumber:[""],expiryDate:[""],cvv:[""],cardHolderName:[""],address:[""],city:[""],zip:[""],comment:[""],items:this.fb.array(this.cartItems.map(t=>this.fb.group({wineId:t.wine.id,quantity:t.quantity})))})}};o.\u0275fac=function(r){return new(r||o)(f(q),f(j),f(G))},o.\u0275cmp=b({type:o,selectors:[["app-checkout"]],standalone:!0,features:[P],decls:68,vars:54,consts:[[1,"wrapper"],[1,"receipt"],[3,"appLangClass"],[1,"eng-primary"],[3,"ngSubmit","formGroup","appLangClass"],[1,"form-group"],["for","card-number"],["type","text","id","card-number","name","card-number","formControlName","cardNumber",1,"form-control"],[1,"split"],["for","expiry-date"],["type","text","id","expiry-date","name","expiry-date","placeholder","MM/YY","formControlName","expiryDate",1,"form-control"],["for","cvc"],["type","text","id","cvc","name","cvc","placeholder","CVC","formControlName","cvv",1,"form-control"],["for","address"],["type","text","id","address","name","address","formControlName","address",1,"form-control",3,"placeholder"],["for","city"],["type","text","id","city","name","city","formControlName","city",1,"form-control",3,"placeholder"],["for","zip"],["type","text","id","zip","name","zip","formControlName","zip",1,"form-control"],["for","comment"],["id","comment","name","comment","formControlName","comment",1,"form-control"],["type","submit",1,"primary-btn",3,"appLangClass"]],template:function(r,u){r&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h5",2),a(4),p(5,"translate"),i(),n(6,"p",2),a(7),p(8,"translate"),i()(),O(9,V,5,3,"div",null,M),s(11,"hr"),n(12,"div")(13,"h6",2),a(14),p(15,"translate"),i(),n(16,"p",3),a(17),i()()(),n(18,"form",4),w("ngSubmit",function(){return u.onSubmit()}),n(19,"h5",2),a(20),p(21,"translate"),i(),n(22,"p"),a(23),p(24,"translate"),i(),n(25,"div",5)(26,"label",6),a(27),p(28,"translate"),i(),s(29,"input",7),i(),n(30,"div",8)(31,"div",5)(32,"label",9),a(33),p(34,"translate"),i(),s(35,"input",10),i(),n(36,"div",5)(37,"label",11),a(38),p(39,"translate"),i(),s(40,"input",12),i()(),n(41,"div",5)(42,"label",13),a(43),p(44,"translate"),i(),s(45,"input",14),p(46,"translate"),i(),n(47,"div",8)(48,"div",5)(49,"label",15),a(50),p(51,"translate"),i(),s(52,"input",16),p(53,"translate"),i(),n(54,"div",5)(55,"label",17),a(56),p(57,"translate"),i(),s(58,"input",18),i()(),n(59,"div",5)(60,"label",19),a(61),p(62,"translate"),i(),s(63,"textarea",20),i(),n(64,"button",21)(65,"span"),a(66),p(67,"translate"),i()()()()),r&2&&(e(3),m("appLangClass","geo-primary, eng-primary, ru-primary"),e(),g(c(5,24,"cart.title")),e(2),m("appLangClass","geo-secondary, eng-secondary, ru-secondary"),e(),x("",u.getTotalQuantity()," ",c(8,26,"cart.items"),""),e(2),_(u.cartItems),e(4),m("appLangClass","geo-secondary, eng-secondary, ru-secondary"),e(),g(c(15,28,"cart.total")),e(3),l("",u.getTotalAmount()," \u20BE"),e(),m("formGroup",u.checkoutForm)("appLangClass","geo-secondary, eng-secondary, ru-secondary"),e(),m("appLangClass","geo-primary, eng-primary, ru-primary"),e(),l(" ",c(21,30,"checkout.title")," "),e(3),l(" ",c(24,32,"checkout.description")," "),e(4),g(c(28,34,"checkout.card-number")),e(6),g(c(34,36,"checkout.expiry-date")),e(5),g(c(39,38,"checkout.cvc")),e(5),l(" ",c(44,40,"checkout.address")," "),e(2),m("placeholder",c(46,42,"checkout.address-placeholder")),e(5),l(" ",c(51,44,"checkout.city")," "),e(2),m("placeholder",c(53,46,"checkout.city-placeholder")),e(4),l(" ",c(57,48,"checkout.zip")," "),e(5),l(" ",c(62,50,"checkout.comment")," "),e(3),m("appLangClass","geo-primary, eng-primary, ru-primary"),e(2),l(" ",c(67,52,"checkout.submit")," "))},dependencies:[E,S,k,z,D,B,N,F,L,T],styles:[".wrapper[_ngcontent-%COMP%]{min-height:calc(100vh - 358px);padding:70px 20px 0;display:flex;flex-direction:column;gap:20px;align-items:center}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%]{padding:20px;width:100%;max-width:345px;aspect-ratio:1/1;border-radius:35px;border:2px solid #4c0027;display:flex;flex-direction:column;justify-content:space-around}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%] > hr[_ngcontent-%COMP%]{border:2px solid #4c0027;border-radius:5px}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px 20px;background-color:#4c0027;border:none;border-radius:5px;color:#fff;font-weight:700;cursor:pointer;transition:.3s}.wrapper[_ngcontent-%COMP%] > .receipt[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:.8}.wrapper[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{width:100%;max-width:345px}.wrapper[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > .form-group[_ngcontent-%COMP%]{width:100%}.wrapper[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]   .split[_ngcontent-%COMP%]{display:flex;gap:20px}@media screen and (min-width: 768px){.wrapper[_ngcontent-%COMP%]{padding:40px 60px 0;min-height:calc(100vh - 436px)}}@media screen and (min-width: 1024px){.wrapper[_ngcontent-%COMP%]{padding:40px 80px 0;flex-direction:row;justify-content:center;gap:60px}}@media screen and (min-width: 1920px){.wrapper[_ngcontent-%COMP%]{min-height:calc(100vh - 474px);padding:40px 12% 0;gap:100px}.wrapper[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{width:50%;max-width:50%}.wrapper[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > .split[_ngcontent-%COMP%] > .form-group[_ngcontent-%COMP%]{width:50%}}"]});let d=o;return d})();export{X as CheckoutComponent};
