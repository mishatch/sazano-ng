import{a as N,c as F,e as R,q as j,r as z}from"./chunk-SA34UV6Y.js";import{a as V}from"./chunk-SHF2QPEZ.js";import"./chunk-H3Z4EEUF.js";import{h as T,t as I}from"./chunk-Y6STU5OE.js";import{Db as s,Eb as d,Fb as O,Ib as P,Jb as L,Kb as B,M as p,Mb as k,Oa as l,Pa as w,Z as E,_a as x,ab as v,ca as h,e as f,eb as S,fa as _,fb as M,gb as U,hb as A,ib as i,jb as t,lb as y,qa as C,ra as b,sb as c,tb as g}from"./chunk-FZWOQZIM.js";var W=(()=>{let n=class n{constructor(e,r){this.http=e,this.loadingService=r,this.apiUrl="https://sazanowine-api-dev.azurewebsites.net/api/identity"}getUsers(){return this.loadingService.show(),this.http.get(`${this.apiUrl}/users`).pipe(p(()=>this.loadingService.hide()))}deleteAdminRole(e){return this.loadingService.show(),this.http.delete(`${this.apiUrl}/userRole`,{body:e}).pipe(p(()=>this.loadingService.hide()))}addAdminRole(e){return this.loadingService.show(),this.http.post(`${this.apiUrl}/userRole`,e).pipe(p(()=>this.loadingService.hide()))}};n.\u0275fac=function(r){return new(r||n)(h(I),h(V))},n.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"});let u=n;return u})();function q(u,n){if(u&1){let a=y();i(0,"tr")(1,"td"),s(2),t(),i(3,"td"),s(4),t(),i(5,"td"),s(6),t(),i(7,"td"),s(8),t(),i(9,"td"),s(10),t(),i(11,"td")(12,"button",10),c("click",function(){let r=C(a).$implicit,o=g(2);return b(o.toggleAdminStatus(r))}),s(13),t()()()}if(u&2){let a=n.$implicit;l(2),d(a.name),l(2),d(a.surName),l(2),d(a.email),l(2),d(a.phoneNumber),l(2),d(a.roles.join(", ")),l(2),v("ngClass",a.roles.includes("Admin")?"btn-danger":"btn-success"),l(),O(" ",a.roles.includes("Admin")?"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10EC\u10D0\u10E8\u10DA\u10D0":"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10DB\u10D8\u10DC\u10D8\u10ED\u10D4\u10D1\u10D0"," ")}}function G(u,n){if(u&1&&(i(0,"div",6)(1,"table",8)(2,"thead",9)(3,"tr")(4,"th"),s(5,"\u10E1\u10D0\u10EE\u10D4\u10DA\u10D8"),t(),i(6,"th"),s(7,"\u10D2\u10D5\u10D0\u10E0\u10D8"),t(),i(8,"th"),s(9,"\u10D4\u10DA. \u10E4\u10DD\u10E1\u10E2\u10D0"),t(),i(10,"th"),s(11,"\u10E2\u10D4\u10DA\u10D4\u10E4\u10DD\u10DC\u10D8\u10E1 \u10DC\u10DD\u10DB\u10D4\u10E0\u10D8"),t(),i(12,"th"),s(13,"\u10E0\u10DD\u10DA\u10D8"),t(),i(14,"th"),s(15,"\u10E1\u10E2\u10D0\u10E2\u10E3\u10E1\u10D8\u10E1 \u10E8\u10D4\u10EA\u10D5\u10DA\u10D0"),t()()(),i(16,"tbody"),U(17,q,14,7,"tr",null,M),t()()()),u&2){let a=g();l(17),A(a.filteredUsers())}}function J(u,n){u&1&&(i(0,"div",7),s(1,"\u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10D4\u10DA\u10D8 \u10D0\u10E0 \u10DB\u10DD\u10D8\u10EB\u10D4\u10D1\u10DC\u10D0"),t())}var ie=(()=>{let n=class n{constructor(e){this.userService=e,this.searchTerm="",this.subscription=new f}ngOnInit(){this.getUsers()}ngOnDestroy(){this.subscription.unsubscribe()}filteredUsers(){if(!this.searchTerm)return this.filteredUsersList;let e=this.searchTerm.toLowerCase();return this.filteredUsersList.filter(r=>r.name.toLowerCase().includes(e)||r.email.toLowerCase().includes(e)||r.phoneNumber.includes(e))}showNormalUsers(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("User")&&!e.roles.includes("Admin"))}showAdmins(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("Admin"))}resetFilter(){this.filteredUsersList=this.users}toggleAdminStatus(e){if(e.roles.includes("Admin")){let r={userEmail:e.email,roleName:"Admin"};this.subscription.add(this.userService.deleteAdminRole(r).subscribe(()=>{e.roles=e.roles.filter(o=>o!=="Admin")},o=>{console.error("Error deleting admin role for user:","Error:",o)}))}else{let r={userEmail:e.email,roleName:"Admin"};this.subscription.add(this.userService.addAdminRole(r).subscribe(()=>{e.roles.push("Admin")},o=>{console.error("Error adding admin role for user:","Error:",o)}))}}getUsers(){this.subscription.add(this.userService.getUsers().subscribe(e=>{this.users=e,this.filteredUsersList=e}))}};n.\u0275fac=function(r){return new(r||n)(w(W))},n.\u0275cmp=_({type:n,selectors:[["app-users-list"]],standalone:!0,features:[k],decls:11,vars:2,consts:[[1,"wrapper","geo-primary"],[1,"buttons-wrapper"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-info",3,"click"],["type","text","placeholder","\u10EB\u10D4\u10D1\u10DC\u10D0",1,"form-control",3,"ngModelChange","ngModel"],[1,"table-wrapper","geo-secondary"],[1,"alert","alert-info"],[1,"table","table-striped","table-bordered"],[1,"thead-dark"],[1,"btn","geo-secondary",3,"click","ngClass"]],template:function(r,o){r&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),c("click",function(){return o.showNormalUsers()}),s(3,"\u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10DA\u10D4\u10D1\u10D8"),t(),i(4,"button",3),c("click",function(){return o.showAdmins()}),s(5,"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1\u10E2\u10E0\u10D0\u10E2\u10DD\u10E0\u10D4\u10D1\u10D8"),t(),i(6,"button",4),c("click",function(){return o.resetFilter()}),s(7,"\u10E7\u10D5\u10D4\u10DA\u10D0 \u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10D4\u10DA\u10D8"),t(),i(8,"input",5),B("ngModelChange",function(D){return L(o.searchTerm,D)||(o.searchTerm=D),D}),t()(),x(9,G,19,0,"div",6)(10,J,2,0,"div",7),t()),r&2&&(l(8),P("ngModel",o.searchTerm),l(),S(o.filteredUsers()&&o.filteredUsers().length>0?9:10))},dependencies:[z,N,F,j,R,T],styles:[".wrapper[_ngcontent-%COMP%]{width:80%;margin:0 auto;padding:80px 20px;min-height:80vh;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;flex-direction:column;align-items:start;width:100%}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > button[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;width:300px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{border:1px solid black}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{width:100%;overflow:auto}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;overflow:auto;font-size:14px}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;width:100%}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:sans-serif}"]});let u=n;return u})();export{ie as UsersListComponent};
