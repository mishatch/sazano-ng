import{a as T,c as I,e as F,o as N,p as R}from"./chunk-LSYD3J5U.js";import{a as j}from"./chunk-OKL6TN3N.js";import"./chunk-JJN6UOWY.js";import{h as L,t as B}from"./chunk-WH2QT74X.js";import{Cb as s,Db as c,Eb as O,Hb as U,Ib as P,Jb as y,Lb as k,M as p,Oa as a,Pa as _,Z as f,ab as w,ca as h,e as g,fa as E,fb as M,gb as S,hb as v,ib as t,jb as i,lb as x,qa as b,ra as C,sb as d,tb as A}from"./chunk-MOSC54PF.js";var z=(()=>{let n=class n{constructor(e,r){this.http=e,this.loadingService=r,this.apiUrl="https://sazanowine-api-dev.azurewebsites.net/api/identity"}getUsers(){return this.loadingService.show(),this.http.get(`${this.apiUrl}/users`).pipe(p(()=>this.loadingService.hide()))}deleteAdminRole(e){return this.loadingService.show(),this.http.delete(`${this.apiUrl}/userRole`,{body:e}).pipe(p(()=>this.loadingService.hide()))}addAdminRole(e){return this.loadingService.show(),this.http.post(`${this.apiUrl}/userRole`,e).pipe(p(()=>this.loadingService.hide()))}};n.\u0275fac=function(r){return new(r||n)(h(B),h(j))},n.\u0275prov=f({token:n,factory:n.\u0275fac,providedIn:"root"});let u=n;return u})();function $(u,n){if(u&1){let l=x();t(0,"tr")(1,"td"),s(2),i(),t(3,"td"),s(4),i(),t(5,"td"),s(6),i(),t(7,"td"),s(8),i(),t(9,"td"),s(10),i(),t(11,"td")(12,"button",9),d("click",function(){let r=b(l).$implicit,o=A();return C(o.toggleAdminStatus(r))}),s(13),i()()()}if(u&2){let l=n.$implicit;a(2),c(l.name),a(2),c(l.surName),a(2),c(l.email),a(2),c(l.phoneNumber),a(2),c(l.roles.join(", ")),a(2),w("ngClass",l.roles.includes("Admin")?"btn-danger":"btn-success"),a(),O(" ",l.roles.includes("Admin")?"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10EC\u10D0\u10E8\u10DA\u10D0":"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10DB\u10D8\u10DC\u10D8\u10ED\u10D4\u10D1\u10D0"," ")}}var Y=(()=>{let n=class n{constructor(e){this.userService=e,this.searchTerm="",this.subscription=new g}ngOnInit(){this.getUsers()}ngOnDestroy(){this.subscription.unsubscribe()}filteredUsers(){if(!this.searchTerm)return this.filteredUsersList;let e=this.searchTerm.toLowerCase();return this.filteredUsersList.filter(r=>r.name.toLowerCase().includes(e))}showNormalUsers(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("User")&&!e.roles.includes("Admin"))}showAdmins(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("Admin"))}resetFilter(){this.filteredUsersList=this.users}toggleAdminStatus(e){if(e.roles.includes("Admin")){let r={userEmail:e.email,roleName:"Admin"};this.subscription.add(this.userService.deleteAdminRole(r).subscribe(()=>{e.roles=e.roles.filter(o=>o!=="Admin")},o=>{console.error("Error deleting admin role for user:","Error:",o)}))}else{let r={userEmail:e.email,roleName:"Admin"};this.subscription.add(this.userService.addAdminRole(r).subscribe(()=>{e.roles.push("Admin")},o=>{console.error("Error adding admin role for user:","Error:",o)}))}}getUsers(){this.subscription.add(this.userService.getUsers().subscribe(e=>{this.users=e,this.filteredUsersList=e}))}};n.\u0275fac=function(r){return new(r||n)(_(z))},n.\u0275cmp=E({type:n,selectors:[["app-users-list"]],standalone:!0,features:[k],decls:28,vars:1,consts:[[1,"wrapper","geo-primary"],[1,"buttons-wrapper"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-info",3,"click"],["type","text","placeholder","\u10EB\u10D4\u10D1\u10DC\u10D0",1,"form-control",3,"ngModelChange","ngModel"],[1,"table-wrapper"],[1,"table","table-striped","table-bordered"],[1,"thead-dark"],[1,"btn",3,"click","ngClass"]],template:function(r,o){r&1&&(t(0,"div",0)(1,"div",1)(2,"button",2),d("click",function(){return o.showNormalUsers()}),s(3,"\u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10DA\u10D4\u10D1\u10D8"),i(),t(4,"button",3),d("click",function(){return o.showAdmins()}),s(5,"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1\u10E2\u10E0\u10D0\u10E2\u10DD\u10E0\u10D4\u10D1\u10D8"),i(),t(6,"button",4),d("click",function(){return o.resetFilter()}),s(7,"\u10E7\u10D5\u10D4\u10DA\u10D0 \u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10D4\u10DA\u10D8"),i(),t(8,"input",5),y("ngModelChange",function(D){return P(o.searchTerm,D)||(o.searchTerm=D),D}),i()(),t(9,"div",6)(10,"table",7)(11,"thead",8)(12,"tr")(13,"th"),s(14,"\u10E1\u10D0\u10EE\u10D4\u10DA\u10D8"),i(),t(15,"th"),s(16,"\u10D2\u10D5\u10D0\u10E0\u10D8"),i(),t(17,"th"),s(18,"\u10D4\u10DA. \u10E4\u10DD\u10E1\u10E2\u10D0"),i(),t(19,"th"),s(20,"\u10E2\u10D4\u10DA\u10D4\u10E4\u10DD\u10DC\u10D8\u10E1 \u10DC\u10DD\u10DB\u10D4\u10E0\u10D8"),i(),t(21,"th"),s(22,"\u10E0\u10DD\u10DA\u10D8"),i(),t(23,"th"),s(24,"\u10E1\u10E2\u10D0\u10E2\u10E3\u10E1\u10D8\u10E1 \u10E8\u10D4\u10EA\u10D5\u10DA\u10D0"),i()()(),t(25,"tbody"),S(26,$,14,7,"tr",null,M),i()()()()),r&2&&(a(8),U("ngModel",o.searchTerm),a(18),v(o.filteredUsers()))},dependencies:[R,T,I,N,F,L],styles:[".wrapper[_ngcontent-%COMP%]{width:80%;margin:0 auto;padding:80px 20px;min-height:80vh;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;flex-direction:column;align-items:start;width:100%}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > button[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;width:300px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{border:1px solid black}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{width:100%;overflow:auto}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;overflow:auto;font-size:14px}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;width:100%}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:sans-serif}"]});let u=n;return u})();export{Y as UsersListComponent};
