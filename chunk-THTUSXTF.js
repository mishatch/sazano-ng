import{a as F,c as N,e as R,k as H,l as j}from"./chunk-MRCQ2FW4.js";import{a as z}from"./chunk-3G3XRZH5.js";import"./chunk-BZ75FBDR.js";import{h as B,q as T,r as I}from"./chunk-GBB3INW7.js";import{Ab as d,Bb as P,Db as U,Eb as O,Fb as y,Hb as k,Oa as a,Pa as C,Z as D,_a as _,ab as b,ca as h,eb as w,fa as g,fb as M,gb as x,hb as A,ib as n,jb as i,kb as v,lb as L,qa as f,qb as p,ra as E,rb as S,zb as o}from"./chunk-VVLVZ75C.js";var V=(()=>{let r=class r{constructor(e){this.http=e,this.apiUrl="https://sazanowine-api-dev.azurewebsites.net/api/identity"}getAuthHeaders(){let e=localStorage.getItem("token")||"";return new T({Authorization:`Bearer ${e}`})}getUsers(){return this.http.get(`${this.apiUrl}/users`,{headers:this.getAuthHeaders()})}deleteAdminRole(e){let t=this.getAuthHeaders();return this.http.delete(`${this.apiUrl}/userRole`,{headers:t,body:e})}addAdminRole(e){let t=this.getAuthHeaders();return this.http.post(`${this.apiUrl}/userRole`,e,{headers:t})}};r.\u0275fac=function(t){return new(t||r)(h(I))},r.\u0275prov=D({token:r,factory:r.\u0275fac,providedIn:"root"});let u=r;return u})();function q(u,r){if(u&1){let l=L();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td")(12,"button",9),p("click",function(){let t=f(l).$implicit,s=S();return E(s.toggleAdminStatus(t))}),o(13),i()()()}if(u&2){let l=r.$implicit;a(2),d(l.name),a(2),d(l.surName),a(2),d(l.email),a(2),d(l.phoneNumber),a(2),d(l.roles.join(", ")),a(2),b("ngClass",l.roles.includes("Admin")?"btn-danger":"btn-success"),a(),P(" ",l.roles.includes("Admin")?"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10EC\u10D0\u10E8\u10DA\u10D0":"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1 \u10DB\u10D8\u10DC\u10D8\u10ED\u10D4\u10D1\u10D0"," ")}}function G(u,r){u&1&&v(0,"app-loading")}var ee=(()=>{let r=class r{constructor(e){this.userService=e,this.searchTerm="",this.isLoading=!0,this.userService.getUsers().subscribe(t=>{this.users=t,this.filteredUsersList=t,this.isLoading=!1})}filteredUsers(){if(!this.searchTerm)return this.filteredUsersList;let e=this.searchTerm.toLowerCase();return this.filteredUsersList.filter(t=>t.name.toLowerCase().includes(e))}showNormalUsers(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("User")&&!e.roles.includes("Admin"))}showAdmins(){this.filteredUsersList=this.users.filter(e=>e.roles.includes("Admin"))}resetFilter(){this.filteredUsersList=this.users}toggleAdminStatus(e){if(e.roles.includes("Admin")){let t={userEmail:e.email,roleName:"Admin"};this.isLoading=!0,this.userService.deleteAdminRole(t).subscribe(s=>{e.roles=e.roles.filter(c=>c!=="Admin"),this.isLoading=!1},s=>{console.error("Error deleting admin role for user:","Error:",s),this.isLoading=!1})}else{let t={userEmail:e.email,roleName:"Admin"};this.isLoading=!0,this.userService.addAdminRole(t).subscribe(s=>{e.roles.push("Admin"),this.isLoading=!1},s=>{console.error("Error adding admin role for user:","Error:",s),this.isLoading=!1})}}};r.\u0275fac=function(t){return new(t||r)(C(V))},r.\u0275cmp=g({type:r,selectors:[["app-users-list"]],standalone:!0,features:[k],decls:29,vars:2,consts:[[1,"wrapper","geo-primary"],[1,"buttons-wrapper"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-info",3,"click"],["type","text","placeholder","\u10EB\u10D4\u10D1\u10DC\u10D0",1,"form-control",3,"ngModelChange","ngModel"],[1,"table-wrapper"],[1,"table","table-striped","table-bordered"],[1,"thead-dark"],[1,"btn",3,"click","ngClass"]],template:function(t,s){t&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),p("click",function(){return s.showNormalUsers()}),o(3,"\u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10DA\u10D4\u10D1\u10D8"),i(),n(4,"button",3),p("click",function(){return s.showAdmins()}),o(5,"\u10D0\u10D3\u10DB\u10D8\u10DC\u10D8\u10E1\u10E2\u10E0\u10D0\u10E2\u10DD\u10E0\u10D4\u10D1\u10D8"),i(),n(6,"button",4),p("click",function(){return s.resetFilter()}),o(7,"\u10E7\u10D5\u10D4\u10DA\u10D0 \u10DB\u10DD\u10DB\u10EE\u10DB\u10D0\u10E0\u10D4\u10D1\u10D4\u10DA\u10D8"),i(),n(8,"input",5),y("ngModelChange",function(m){return O(s.searchTerm,m)||(s.searchTerm=m),m}),i()(),n(9,"div",6)(10,"table",7)(11,"thead",8)(12,"tr")(13,"th"),o(14,"\u10E1\u10D0\u10EE\u10D4\u10DA\u10D8"),i(),n(15,"th"),o(16,"\u10D2\u10D5\u10D0\u10E0\u10D8"),i(),n(17,"th"),o(18,"\u10D4\u10DA. \u10E4\u10DD\u10E1\u10E2\u10D0"),i(),n(19,"th"),o(20,"\u10E2\u10D4\u10DA\u10D4\u10E4\u10DD\u10DC\u10D8\u10E1 \u10DC\u10DD\u10DB\u10D4\u10E0\u10D8"),i(),n(21,"th"),o(22,"\u10E0\u10DD\u10DA\u10D8"),i(),n(23,"th"),o(24,"\u10E1\u10E2\u10D0\u10E2\u10E3\u10E1\u10D8\u10E1 \u10E8\u10D4\u10EA\u10D5\u10DA\u10D0"),i()()(),n(25,"tbody"),x(26,q,14,7,"tr",null,M),i()()()(),_(28,G,1,0,"app-loading")),t&2&&(a(8),U("ngModel",s.searchTerm),a(18),A(s.filteredUsers()),a(2),w(s.isLoading?28:-1))},dependencies:[z,j,F,N,H,R,B],styles:[".wrapper[_ngcontent-%COMP%]{width:80%;margin:0 auto;padding:80px 20px;min-height:80vh;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px;flex-direction:column;align-items:start;width:100%}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > button[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;width:300px}.wrapper[_ngcontent-%COMP%]   .buttons-wrapper[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{border:1px solid black}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{width:100%;overflow:auto}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;overflow:auto;font-size:14px}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;width:100%}.wrapper[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:sans-serif}"]});let u=r;return u})();export{ee as UsersListComponent};
